(this.webpackJsonpartisto=this.webpackJsonpartisto||[]).push([[10],{106:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return f}));var n=r(55),a=r.n(n),c=r(56),s=r(30),u=r(3),o=r(60),i=r(8),l=r(57),p=r(61),d=r(4);function f(){var e=Object(u.useState)(null),t=Object(s.a)(e,2),r=t[0],n=t[1],f=Object(u.useState)(null),b=Object(s.a)(f,2),h=b[0],m=b[1],j=Object(u.useState)(""),x=Object(s.a)(j,2),O=x[0],w=x[1],v=Object(u.useState)(!1),g=Object(s.a)(v,2),y=g[0],k=g[1],N=Object(i.g)();Object(u.useEffect)((function(){document.title="Post - Artisto"}),[]);var I=Object(p.a)().userInfo,L=I.userId,C=I.username,M=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,Object(l.k)(O,h,L,k);case 3:N.push("/p/".concat(C));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=!r||!O;return Object(d.jsxs)("div",{children:[Object(d.jsx)(o.a,{}),y&&Object(d.jsx)("div",{className:"flex absolute top-0 left-0 w-screen h-screen bg-gray-dark opacity-70 z-90 items-center justify-center",children:Object(d.jsx)("p",{className:"text-2xl text-gray-light bg-gradient-to-r from-blue-primary via-yellow-primary to-red-primary py-4 px-8 rounded animate-pulse",children:"Uploading..."})}),Object(d.jsx)("div",{className:"container max-w-screen-lg mx-auto px-4 mb-8",children:Object(d.jsx)("div",{className:"pt-20 flex max-h-screen",children:Object(d.jsxs)("form",{onSubmit:M,className:"sm:flex w-full max-w-screen-lg mx-auto",children:[Object(d.jsx)("div",{className:"sm:w-1/2 pb-4 sm:pb-0 max-h-full",children:Object(d.jsxs)("div",{className:"border-gray-light border-dotted border-4 flex relative h-60 sm:h-96 max-h-full items-center justify-center rounded-xl",children:[r&&Object(d.jsx)("button",{onClick:function(e){e.preventDefault(),n(null)},className:"absolute top-0 left-0",children:Object(d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-red-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r?Object(d.jsx)("div",{className:"flex w-full h-full",children:Object(d.jsx)("img",{src:r,className:"p-4 m-4 mx-auto object-contain"})}):Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{htmlFor:"imageUploader",className:"cursor-pointer text-gray-light bg-blue-primary p-2 rounded",children:"Choose Image"}),Object(d.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){m(e.target.files),e.target.files&&e.target.files[0]&&n(URL.createObjectURL(e.target.files[0]))},className:"text-gray-light text-center hidden",id:"imageUploader"})]})]})}),Object(d.jsx)("div",{className:"sm:w-1/2 sm:h-96 flex justify-center items-end sm:pl-8 max-h-full ",children:Object(d.jsxs)("div",{className:"w-full",children:[Object(d.jsx)("textarea",{placeholder:"Write a caption...",onChange:function(e){var t=e.target;return w(t.value)},value:O,className:"h-32 p-4 w-full rounded"}),Object(d.jsx)("button",{type:"submit",disabled:S,className:"mt-4 bg-yellow-primary text-gray-dark py-2 px-6 rounded mx-auto sm:mx-0 block ".concat(S&&"opacity-50"),children:"Post"})]})})]})})})]})}},57:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"g",(function(){return m})),r.d(t,"h",(function(){return x})),r.d(t,"a",(function(){return w})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return k})),r.d(t,"i",(function(){return S})),r.d(t,"c",(function(){return P})),r.d(t,"f",(function(){return z})),r.d(t,"j",(function(){return D})),r.d(t,"k",(function(){return H}));var n=r(30),a=r(17),c=r(55),s=r.n(c),u=r(56),o=r(23),i=r(62),l=r.n(i),p=r(63),d="".concat("dvhwserkv"),f="".concat("s4onxndn");function b(e){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("users").where("username","==",t).get();case 2:return r=e.sent,e.abrupt("return",r.docs.length>0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(s.a.mark((function e(t){var r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("users").where("userId","==",t).get();case 2:return r=e.sent,n=r.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return O.apply(this,arguments)}function O(){return(O=Object(u.a)(s.a.mark((function e(t){var r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("users").where("username","==",t).get();case 2:return r=e.sent,n=r.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(s.a.mark((function e(t,r){var c,u,i,l,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("users").where("username","==",t).where("following","array-contains",r).get();case 2:return c=e.sent,u=c.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),i=Object(n.a)(u,1),l=i[0],p=void 0===l?{}:l,e.abrupt("return",p.userId);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){return y.apply(this,arguments)}function y(){return(y=Object(u.a)(s.a.mark((function e(t,r){var c,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("photos").where("userId","in",t).get();case 2:return c=e.sent,i=c.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.next=6,Promise.all(i.map(function(){var e=Object(u.a)(s.a.mark((function e(t){var c,u,o,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=!1,t.likes.includes(r)&&(c=!0),e.next=4,m(t.userId);case 4:return u=e.sent,o=Object(n.a)(u,1),i=o[0],l=i.username,e.abrupt("return",Object(a.a)(Object(a.a)({username:l},t),{},{userLikedPhoto:c}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return l=e.sent,e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(s.a.mark((function e(t,r,n){var c,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.firestore().collection("photos").where("userId","==",r).get();case 2:return c=e.sent,i=c.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.next=6,Promise.all(i.map(function(){var e=Object(u.a)(s.a.mark((function e(r){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=!1,r.likes.includes(t)&&(c=!0),e.abrupt("return",Object(a.a)(Object(a.a)({username:n},r),{},{userLikedPhoto:c}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return l=e.sent,e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(s.a.mark((function e(t,r,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.b.firestore().collection("users").doc(t).update({following:n?o.a.arrayRemove(r):o.a.arrayUnion(r)});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t,r){return M.apply(this,arguments)}function M(){return(M=Object(u.a)(s.a.mark((function e(t,r,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.b.firestore().collection("users").doc(t).update({followers:n?o.a.arrayRemove(r):o.a.arrayUnion(r)});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r,n,a){return W.apply(this,arguments)}function W(){return(W=Object(u.a)(s.a.mark((function e(t,r,n,a,c){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t,a,c);case 2:return e.next=4,C(n,r,c);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return U.apply(this,arguments)}function U(){return(U=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:return r=e.sent,a=Object(n.a)(r,1),c=a[0],e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(s.a.mark((function e(t,r){var n,c,u,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return e.next=3,o.b.firestore().collection("users").where("category","==",t).get();case 3:return n=e.sent,c=n.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.abrupt("return",c);case 8:return e.next=10,o.b.firestore().collection("users").limit(10).where("category","==",t).get();case 10:return u=e.sent,i=u.docs.map((function(e){return Object(a.a)(Object(a.a)({},e.data()),{},{docId:e.id})})),e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,r,n,a,c,s){return _.apply(this,arguments)}function _(){return(_=Object(u.a)(s.a.mark((function e(t,r,n,a,c,u,i){var b,h,m,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i(!0),!u){e.next=24;break}return b="",h={maxSizeMB:1,maxWidthOrHeight:400},e.prev=4,e.next=7,Object(p.a)(u[0],h);case 7:return m=e.sent,(j=new FormData).append("file",m),j.append("upload_preset",f),e.next=13,l.a.post("https://api.cloudinary.com/v1_1/".concat(d,"/image/upload"),j).then((function(e){var t=e.data;b=t.secure_url}));case 13:return e.next=15,o.b.firestore().collection("users").doc(t).update({fullName:r,category:n,title:a,bio:c,photo:b});case 15:i(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),i(!1),alert(e.t0.message);case 22:e.next=27;break;case 24:return e.next=26,o.b.firestore().collection("users").doc(t).update({fullName:r,category:n,title:a,bio:c});case 26:i(!1);case 27:case"end":return e.stop()}}),e,null,[[4,18]])})))).apply(this,arguments)}function H(e,t,r,n){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(s.a.mark((function e(t,r,n,a){var c,u,i,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="",u={maxWidthOrHeight:2e3},a(!0),e.prev=3,e.next=6,Object(p.a)(r[0],u);case 6:return i=e.sent,(b=new FormData).append("file",i),b.append("upload_preset",f),e.next=12,l.a.post("https://api.cloudinary.com/v1_1/".concat(d,"/image/upload"),b).then((function(e){var t=e.data;c=t.secure_url}));case 12:return e.next=14,o.b.firestore().collection("photos").add({caption:t,comments:[],dateCreated:Date.now(),imageSrc:c,likes:[],photoId:n+Date.now(),userId:n,userLatitude:34.0522,userLongitude:-188.2437});case 14:a(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),a(!1),alert(e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[3,17]])})))).apply(this,arguments)}},58:function(e,t,r){"use strict";t.a=r.p+"static/media/logo.6dc95425.png"},60:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(55),a=r.n(n),c=r(56),s=r(30),u=r(3),o=r(58),i=r(8),l=r(18),p=r(11),d=r(31),f=r(20),b=r(57),h=r(4);function m(){var e=Object(u.useState)(""),t=Object(s.a)(e,2),r=t[0],n=t[1],m=Object(u.useContext)(d.a).user.uid,j=Object(u.useContext)(f.a).firebase,x=Object(i.g)();return Object(u.useEffect)((function(){var e=null;m&&function(){var t=Object(c.a)(a.a.mark((function t(){var r,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=9;break}return t.next=3,Object(b.g)(m);case 3:r=t.sent,c=Object(s.a)(r,1),e=c[0],n(e),t.next=0;break;case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[m]),r?Object(h.jsx)("div",{className:"bg-gray-dark w-screen h-14 flex justify-center items-center fixed z-50 top-0 left-0",children:Object(h.jsxs)("div",{className:"max-w-screen-xl w-full h-14 flex justify-between items-center",children:[Object(h.jsx)(l.b,{to:p.a,children:Object(h.jsx)("h1",{className:"flex sm:h-14 sm:w-auto w-28",children:Object(h.jsx)("img",{src:o.a,alt:"artisto",className:"sm:h-full sm:w-auto w-full h-auto"})})}),Object(h.jsxs)("div",{className:"flex flex-row items-center",children:[Object(h.jsx)("div",{className:"pr-2 sm:pr-4",children:Object(h.jsx)(l.b,{to:p.i,children:Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-8 sm:w-8 text-gray-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})})}),Object(h.jsx)("div",{className:"pr-2 sm:pr-4",children:Object(h.jsx)(l.b,{to:p.g,children:Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-8 sm:w-8 text-gray-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}),Object(h.jsx)("div",{className:"pr-2 sm:pr-4",children:Object(h.jsx)(l.b,{to:p.c,children:Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-8 sm:w-8 text-gray-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})}),Object(h.jsx)("div",{className:"flex h-14 items-center pr-2 sm:pr-4",children:Object(h.jsx)(l.b,{to:"/p/".concat(null===r||void 0===r?void 0:r.username),children:Object(h.jsx)("img",{src:null===r||void 0===r?void 0:r.photo,className:"h-5 w-5 sm:h-10 sm:w-10 rounded-full object-cover"})})}),Object(h.jsx)("div",{className:"pr-2 sm:pr-4 cursor-pointer",onClick:function(){j.auth().signOut(),x.push(p.b)},children:Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-8 sm:w-8 text-gray-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})}):null}},61:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(55),a=r.n(n),c=r(56),s=r(30),u=r(3),o=r(31),i=r(57);function l(){var e=Object(u.useContext)(o.a).user,t=Object(u.useState)({}),r=Object(s.a)(t,2),n=r[0],l=r[1];return Object(u.useEffect)((function(){function t(){return(t=Object(c.a)(a.a.mark((function t(){var r,n,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.g)(e.uid);case 2:r=t.sent,n=Object(s.a)(r,1),c=n[0],l(c);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(null===e||void 0===e?void 0:e.uid)&&function(){t.apply(this,arguments)}()}),[e]),{userInfo:n}}}}]);
//# sourceMappingURL=10.67d85cae.chunk.js.map